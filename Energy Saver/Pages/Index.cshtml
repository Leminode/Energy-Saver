@page
@using System.ComponentModel
@using Microsoft.AspNetCore.Mvc.ModelBinding
@using System.Reflection
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<div class="text-center">
    <h1 class="display-4 text-color">Energy Saver</h1>
</div>
<div class="main-div">
    @if(User.Identity.IsAuthenticated){
        <table class="table" id="tax-list">
            <thead>
                <tr>
                    <th style="text-align:left">Year</th>
                    <th style="text-align:left">Month</th>
                    <th style="text-align:left">Gas amount</th>
                    <th style="text-align:left">Electricity amount</th>
                    <th style="text-align:left">Water amount</th>
                    <th style="text-align:left">Heating amount</th>
                    <th style="text-align:left">Options</th>
                </tr>
            </thead>
            @foreach (var item in Model.Taxes)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Year)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Month)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GasAmount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ElectricityAmount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaterAmount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.HeatingAmount)
                    </td>
                    <td class="text-color">
                        <a asp-page="./Edit" asp-route-id="@item.ID" class="text-color">Edit</a> |
                        <a asp-page="./Details" asp-route-id="@item.ID" class="text-color">Details</a> |
                        <a asp-page="./Delete" asp-route-id="@item.ID" class="text-color">Delete</a>
                    </td>
                </tr>
            }
        </table>
        <body>
            <div>
                @{
                    string[] comparison = new string[4];

                    comparison[0] = Model.gasComparison >= 0 ? "higher" : "lower";
                    comparison[1] = Model.electricityComparison >= 0 ? "higher" : "lower";
                    comparison[2] = Model.waterComparison >= 0 ? "higher" : "lower";
                    comparison[3] = Model.heatingComparison >= 0 ? "higher" : "lower";
                }
                <p class="text-color" style="margin-top: 40px">Total gas consumption this month is <span class="@(comparison[0] == "higher" ? "text-negative" : "text-positive")">@Math.Abs(Model.gasComparison)%</span> @comparison[0] than last month</p>

                <p class="text-color" style="margin-top: 40px">Total electricity consumption this month is <span class="@(comparison[1] == "higher" ? "text-negative" : "text-positive")">@Math.Abs(Model.electricityComparison)%</span> @comparison[1] than last month</p>

            <p class="text-color" style="margin-top: 40px">Total water consumption this month is <span class="@(comparison[2] == "higher" ? "text-negative" : "text-positive")">@Math.Abs(Model.waterComparison)%</span> @comparison[2] than last month</p>

            <p class="text-color" style="margin-top: 40px">Total heating consumption this month is <span class="@(comparison[3] == "higher" ? "text-negative" : "text-positive")">@Math.Abs(Model.heatingComparison)%</span> @comparison[3] than last month</p>
            </div>
        </body>
    }
    else
    {
        <body>
            <div>
                <p class="text-color" style="text-align:center">Please log in or sign up to see tax history</p>
            </div>
        </body>
    }
</div>